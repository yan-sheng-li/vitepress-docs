import{_ as i,c as a,o as t,aj as e}from"./chunks/framework.VtnL2jmu.js";const c=JSON.parse('{"title":"镜像加速","description":"","frontmatter":{},"headers":[],"relativePath":"docker/镜像加速.md","filePath":"docker/镜像加速.md"}'),n={name:"docker/镜像加速.md"};function l(h,s,p,k,r,o){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="镜像加速" tabindex="-1">镜像加速 <a class="header-anchor" href="#镜像加速" aria-label="Permalink to “镜像加速”">​</a></h1><p>参考 <a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noreferrer">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><h2 id="镜像拉取失败问题" tabindex="-1">镜像拉取失败问题 <a class="header-anchor" href="#镜像拉取失败问题" aria-label="Permalink to “镜像拉取失败问题”">​</a></h2><div class="danger custom-block"><p class="custom-block-title">报错如下：</p><p>Error response from daemon: Get &quot;<a href="https://index.docker.io/v1/search?q=java&amp;n=25" target="_blank" rel="noreferrer">https://index.docker.io/v1/search?q=java&amp;n=25</a>&quot;: dial tcp 108.160.165.141:443: i/o timeout</p></div><p>我遇到的问题是，能ping通外网，但就是<code>dokcer search xxx</code>不了，提示上面的错误，-_-||</p><p>网上各种方案尝试过，不大好使</p><blockquote><p>采取<code>使用特定的镜像名称和标签进行拉取</code>,OK</p></blockquote><p>例如，执行docker pull openjdk:8-jre-alpine来拉取一个具体的 Java 镜像，而不是使用模糊的搜索后再拉取。</p><p><strong>解决方案：更换为当前（2025年底）国内还能正常使用的镜像加速器。</strong></p><h3 id="推荐配置-ubuntu-系统" tabindex="-1">推荐配置（Ubuntu 系统） <a class="header-anchor" href="#推荐配置-ubuntu-系统" aria-label="Permalink to “推荐配置（Ubuntu 系统）”">​</a></h3><ol><li><p>编辑 Docker 配置文件的（如果文件不存在就新建）：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/docker/daemon.json</span></span></code></pre></div></li><li><p>写入以下内容（推荐多加几个源，提高可用性和速度，按优先级排序）：</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;registry-mirrors&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://docker.1ms.run&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 毫秒镜像，速度快</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://docker.xuanyuan.me&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 轩辕免费版</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://xuanyuan.cloud&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 轩辕专业版（需注册，但更稳定）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://docker.1panel.live&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1Panel 官方</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://proxy.1panel.live&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://docker.m.daocloud.io&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// DaoCloud</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://docker.nju.edu.cn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 南京大学（部分可用）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 上海交大</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><blockquote><p>你可以只选前 3-5 个，避免太多导致配置复杂。</p></blockquote></li><li><p>保存退出后，重启 Docker 服务：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span></code></pre></div></li><li><p>验证配置是否生效：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mirrors</span></span></code></pre></div><p>会显示你配置的镜像源列表。</p></li><li><p>测试拉取镜像：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node:latest</span></span></code></pre></div><p>现在应该能正常下载了，速度也会明显更快。</p></li></ol><h3 id="如果还是不行-备用方案" tabindex="-1">如果还是不行（备用方案） <a class="header-anchor" href="#如果还是不行-备用方案" aria-label="Permalink to “如果还是不行（备用方案）”">​</a></h3><ul><li><p><strong>临时单次拉取</strong>（不改配置，直接用加速前缀）：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker.1ms.run/library/node:latest</span></span></code></pre></div><p>然后打 tag 成本地镜像：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker.1ms.run/library/node:latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node:latest</span></span></code></pre></div></li><li><p><strong>阿里云个人加速器</strong>（最稳定，推荐生产用）： 登录阿里云容器镜像服务 <a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noreferrer">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a> ，左侧“镜像加速器”里会给你生成专属地址（类似 <a href="https://xxxxxx.mirror.aliyuncs.com" target="_blank" rel="noreferrer">https://xxxxxx.mirror.aliyuncs.com</a>），复制进去 daemon.json 即可。</p></li><li><p>如果你在虚拟机网络有问题，顺便检查下 DNS（不过这个错误主要是镜像源域名失效）：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/resolv.conf</span></span></code></pre></div><p>加一行：<code>nameserver 8.8.8.8</code> 或 <code>nameserver 114.114.114.114</code></p></li></ul><p>配置好后，拉取 node:latest 之类的镜像就没问题了。现在国内很多老的镜像源都失效了，记得用上面这些新的。</p>`,14)])])}const g=i(n,[["render",l]]);export{c as __pageData,g as default};
