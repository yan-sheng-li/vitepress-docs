import{_ as i,c as a,o as h,aj as t}from"./chunks/framework.VtnL2jmu.js";const g=JSON.parse('{"title":"环境变量&dotenv","description":"","frontmatter":{},"headers":[],"relativePath":"Python/环境变量&dotenv.md","filePath":"Python/环境变量&dotenv.md"}'),n={name:"Python/环境变量&dotenv.md"};function l(e,s,k,p,d,r){return h(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="环境变量-dotenv" tabindex="-1">环境变量&amp;dotenv <a class="header-anchor" href="#环境变量-dotenv" aria-label="Permalink to “环境变量&amp;dotenv”">​</a></h1><h2 id="一、为什么要用环境变量" tabindex="-1">一、为什么要用环境变量？ <a class="header-anchor" href="#一、为什么要用环境变量" aria-label="Permalink to “一、为什么要用环境变量？”">​</a></h2><p>作用：</p><ul><li>存放配置（数据库地址、API Key、路径等）</li><li>避免把敏感信息写死在代码里</li><li>区分开发 / 测试 / 生产环境</li><li>提高项目可维护性</li></ul><hr><h2 id="二、-env-文件是什么" tabindex="-1">二、<code>.env</code> 文件是什么？ <a class="header-anchor" href="#二、-env-文件是什么" aria-label="Permalink to “二、.env 文件是什么？”">​</a></h2><p><code>.env</code> 是一个普通文本文件，用来写：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>DB_HOST=localhost</span></span>
<span class="line"><span>DB_USER=root</span></span>
<span class="line"><span>DATA_DIR=/mnt/data</span></span>
<span class="line"><span>DEBUG=True</span></span></code></pre></div><p>⚠ 注意：</p><ul><li>每行是 <code>KEY=VALUE</code></li><li>不要有空格（除非用引号）</li><li>一般加入 <code>.gitignore</code></li></ul><hr><h2 id="三、load-dotenv-的作用" tabindex="-1">三、<code>load_dotenv()</code> 的作用 <a class="header-anchor" href="#三、load-dotenv-的作用" aria-label="Permalink to “三、load_dotenv() 的作用”">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dotenv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_dotenv</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">load_dotenv()</span></span></code></pre></div><p>作用：</p><blockquote><p>读取 <code>.env</code> 文件 把里面的变量加载到 <code>os.environ</code> 中</p></blockquote><p>安装：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python-dotenv</span></span></code></pre></div><hr><h2 id="四、读取环境变量的几种方式" tabindex="-1">四、读取环境变量的几种方式 <a class="header-anchor" href="#四、读取环境变量的几种方式" aria-label="Permalink to “四、读取环境变量的几种方式”">​</a></h2><h4 id="_1️⃣-基本读取" tabindex="-1">1️⃣ 基本读取 <a class="header-anchor" href="#_1️⃣-基本读取" aria-label="Permalink to “1️⃣ 基本读取”">​</a></h4><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATA_DIR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>如果不存在 → 返回 <code>None</code></p><hr><h4 id="_2️⃣-设置默认值-推荐写法" tabindex="-1">2️⃣ 设置默认值（推荐写法） <a class="header-anchor" href="#_2️⃣-设置默认值-推荐写法" aria-label="Permalink to “2️⃣ 设置默认值（推荐写法）”">​</a></h4><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DATA_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATA_DIR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>含义：</p><ul><li>有环境变量 → 用它</li><li>没有 → 用 <code>&quot;data&quot;</code></li></ul><p>✔ 推荐 ✔ 工程中常用 ✔ 有兜底机制</p><hr><h4 id="_3️⃣-强制必须存在" tabindex="-1">3️⃣ 强制必须存在 <a class="header-anchor" href="#_3️⃣-强制必须存在" aria-label="Permalink to “3️⃣ 强制必须存在”">​</a></h4><h6 id="写法一-更安全" tabindex="-1">写法一（更安全） <a class="header-anchor" href="#写法一-更安全" aria-label="Permalink to “写法一（更安全）”">​</a></h6><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DATA_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATA_DIR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> DATA_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    raise</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ValueError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATA_DIR 未设置&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h6 id="写法二-更简洁" tabindex="-1">写法二（更简洁） <a class="header-anchor" href="#写法二-更简洁" aria-label="Permalink to “写法二（更简洁）”">​</a></h6><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DATA_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.environ[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATA_DIR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>如果不存在会直接报 <code>KeyError</code></p><p>适合生产环境必须配置的变量。</p><hr><h2 id="五、⚠-重要注意事项" tabindex="-1">五、⚠ 重要注意事项 <a class="header-anchor" href="#五、⚠-重要注意事项" aria-label="Permalink to “五、⚠ 重要注意事项”">​</a></h2><h4 id="_1️⃣-环境变量永远是字符串" tabindex="-1">1️⃣ 环境变量永远是字符串 <a class="header-anchor" href="#_1️⃣-环境变量永远是字符串" aria-label="Permalink to “1️⃣ 环境变量永远是字符串”">​</a></h4><p>例如：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>DEBUG=False</span></span>
<span class="line"><span>PORT=8000</span></span></code></pre></div><p>读取后：</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DEBUG&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">port </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PORT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(debug))  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## str</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(port))   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## str</span></span></code></pre></div><h6 id="正确转换方式" tabindex="-1">正确转换方式： <a class="header-anchor" href="#正确转换方式" aria-label="Permalink to “正确转换方式：”">​</a></h6><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DEBUG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DEBUG&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;False&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).lower() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;true&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PORT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><hr><h4 id="_2️⃣-env-不要提交到-git" tabindex="-1">2️⃣ <code>.env</code> 不要提交到 Git <a class="header-anchor" href="#_2️⃣-env-不要提交到-git" aria-label="Permalink to “2️⃣ .env 不要提交到 Git”">​</a></h4><p>在 <code>.gitignore</code> 里加：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>.env</span></span></code></pre></div><p>避免泄露：</p><ul><li>API key</li><li>数据库密码</li><li>云服务密钥</li></ul><hr><h4 id="_3️⃣-load-dotenv-只需要调用一次" tabindex="-1">3️⃣ load_dotenv() 只需要调用一次 <a class="header-anchor" href="#_3️⃣-load-dotenv-只需要调用一次" aria-label="Permalink to “3️⃣ load_dotenv() 只需要调用一次”">​</a></h4><p>通常放在：</p><ul><li>项目入口文件</li><li>main.py</li><li>app.py</li></ul><hr><h2 id="六、推荐的标准写法-实战风格" tabindex="-1">六、推荐的标准写法（实战风格） <a class="header-anchor" href="#六、推荐的标准写法-实战风格" aria-label="Permalink to “六、推荐的标准写法（实战风格）”">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dotenv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_dotenv</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">load_dotenv()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DATA_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DATA_DIR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DEBUG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DEBUG&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;False&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).lower() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;true&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(os.getenv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PORT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p>这种写法：</p><p>✔ 可读性高 ✔ 有默认值 ✔ 类型正确 ✔ 生产可用</p><hr><h2 id="七、一句话总结" tabindex="-1">七、一句话总结 <a class="header-anchor" href="#七、一句话总结" aria-label="Permalink to “七、一句话总结”">​</a></h2><ul><li><code>.env</code> = 存配置</li><li><code>load_dotenv()</code> = 加载配置</li><li><code>os.getenv(key, default)</code> = 读取配置 + 默认值</li><li>环境变量永远是字符串，记得转换类型</li></ul><hr>`,64)])])}const E=i(n,[["render",l]]);export{g as __pageData,E as default};
